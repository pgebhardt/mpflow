// --------------------------------------------------------------------
// This file is part of mpFlow.
//
// mpFlow is free software: you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation, either version 2 of the License, or
// (at your option) any later version.
//
// mpFlow is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License
// along with mpFlow. If not, see <http://www.gnu.org/licenses/>.
//
// Copyright (C) 2014 Patrik Gebhardt
// Contact: patrik.gebhardt@rub.de
// --------------------------------------------------------------------

#include <cmath>
#include "mpflow/mpflow.h"

using namespace std;

// create basis class
mpFlow::FEM::basis::Edge::Edge (
    std::array<std::tuple<dtype::real, dtype::real>, Linear::nodesPerElement> nodes,
    std::tuple<dtype::index, dtype::index> edge) :
    nodes(nodes), nodeBasis({{ Linear(nodes, std::get<0>(edge)), Linear(nodes, std::get<1>(edge)) }}) {
    // calculate length of edge
    this->length = sqrt(math::square(std::get<0>(nodes[std::get<1>(edge)]) - std::get<0>(nodes[std::get<0>(edge)])) +
                        math::square(std::get<1>(nodes[std::get<1>(edge)]) - std::get<1>(nodes[std::get<0>(edge)])));
}

// evaluate basis function

std::tuple<mpFlow::dtype::real, mpFlow::dtype::real> mpFlow::FEM::basis::Edge::evaluate(
    std::tuple<dtype::real, dtype::real> point
    ) {
    return std::make_tuple(
        ({
((this->length)*(((-(this->nodeBasis[0].coefficients[1]))*((((std::get<0>(point))*(this->nodeBasis[1].coefficients[1]))+((std::get<1>(point))*(this->nodeBasis[1].coefficients[2])))+(this->nodeBasis[1].coefficients[0])))+((this->nodeBasis[1].coefficients[1])*((((std::get<0>(point))*(this->nodeBasis[0].coefficients[1]))+((std::get<1>(point))*(this->nodeBasis[0].coefficients[2])))+(this->nodeBasis[0].coefficients[0])))));
})
,
        ({
((this->length)*(((-(this->nodeBasis[0].coefficients[2]))*((((std::get<0>(point))*(this->nodeBasis[1].coefficients[1]))+((std::get<1>(point))*(this->nodeBasis[1].coefficients[2])))+(this->nodeBasis[1].coefficients[0])))+((this->nodeBasis[1].coefficients[2])*((((std::get<0>(point))*(this->nodeBasis[0].coefficients[1]))+((std::get<1>(point))*(this->nodeBasis[0].coefficients[2])))+(this->nodeBasis[0].coefficients[0])))));
})

        );
}



mpFlow::dtype::real mpFlow::FEM::basis::Edge::rot(
    std::tuple<dtype::real, dtype::real> point
    ) {
    return ({
(((-(this->length))*(((-(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))+((this->nodeBasis[0].coefficients[2])*(this->nodeBasis[1].coefficients[1]))))+((this->length)*(((this->nodeBasis[0].coefficients[1])*(this->nodeBasis[1].coefficients[2]))-((this->nodeBasis[0].coefficients[2])*(this->nodeBasis[1].coefficients[1])))));
})
;
}


// integrate with basis

mpFlow::dtype::real mpFlow::FEM::basis::Edge::integrateWithBasis(
    const std::shared_ptr<Edge> other
    ) {
    return ({
(((1.0)*(((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((0.0833333333333)*((std::get<0>(this->nodes[0]))*(std::get<0>(this->nodes[0]))))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2]))-((((((((0.0833333333333)*((std::get<0>(this->nodes[0]))*(std::get<0>(this->nodes[0]))))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1])))-((((((((0.0833333333333)*((std::get<0>(this->nodes[0]))*(std::get<0>(this->nodes[0]))))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2])))+((((((((0.0833333333333)*((std::get<0>(this->nodes[0]))*(std::get<0>(this->nodes[0]))))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1])))+(((((((((0.0833333333333)*(std::get<0>(this->nodes[0])))*(std::get<0>(this->nodes[1])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2])))-(((((((((0.0833333333333)*(std::get<0>(this->nodes[0])))*(std::get<0>(this->nodes[1])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1])))-(((((((((0.0833333333333)*(std::get<0>(this->nodes[0])))*(std::get<0>(this->nodes[1])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2])))+(((((((((0.0833333333333)*(std::get<0>(this->nodes[0])))*(std::get<0>(this->nodes[1])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1])))+(((((((((0.0833333333333)*(std::get<0>(this->nodes[0])))*(std::get<0>(this->nodes[2])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2])))-(((((((((0.0833333333333)*(std::get<0>(this->nodes[0])))*(std::get<0>(this->nodes[2])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1])))-(((((((((0.0833333333333)*(std::get<0>(this->nodes[0])))*(std::get<0>(this->nodes[2])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2])))+(((((((((0.0833333333333)*(std::get<0>(this->nodes[0])))*(std::get<0>(this->nodes[2])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1])))+((((((((0.166666666667)*(std::get<0>(this->nodes[0])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[0]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2])))-((((((((0.166666666667)*(std::get<0>(this->nodes[0])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[0]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1])))+((((((((0.166666666667)*(std::get<0>(this->nodes[0])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[0]))*(other->nodeBasis[1].coefficients[2])))-((((((((0.166666666667)*(std::get<0>(this->nodes[0])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[0])))-((((((((0.166666666667)*(std::get<0>(this->nodes[0])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[0]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2])))+((((((((0.166666666667)*(std::get<0>(this->nodes[0])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[0]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1])))-((((((((0.166666666667)*(std::get<0>(this->nodes[0])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[0]))*(other->nodeBasis[1].coefficients[2])))+((((((((0.166666666667)*(std::get<0>(this->nodes[0])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[0])))+((((((((0.0833333333333)*((std::get<1>(this->nodes[0]))*(std::get<1>(this->nodes[0]))))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2])))-((((((((0.0833333333333)*((std::get<1>(this->nodes[0]))*(std::get<1>(this->nodes[0]))))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1])))-((((((((0.0833333333333)*((std::get<1>(this->nodes[0]))*(std::get<1>(this->nodes[0]))))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2])))+((((((((0.0833333333333)*((std::get<1>(this->nodes[0]))*(std::get<1>(this->nodes[0]))))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1])))+(((((((((0.0833333333333)*(std::get<1>(this->nodes[0])))*(std::get<1>(this->nodes[1])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2])))-(((((((((0.0833333333333)*(std::get<1>(this->nodes[0])))*(std::get<1>(this->nodes[1])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1])))-(((((((((0.0833333333333)*(std::get<1>(this->nodes[0])))*(std::get<1>(this->nodes[1])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2])))+(((((((((0.0833333333333)*(std::get<1>(this->nodes[0])))*(std::get<1>(this->nodes[1])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1])))+(((((((((0.0833333333333)*(std::get<1>(this->nodes[0])))*(std::get<1>(this->nodes[2])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2])))-(((((((((0.0833333333333)*(std::get<1>(this->nodes[0])))*(std::get<1>(this->nodes[2])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1])))-(((((((((0.0833333333333)*(std::get<1>(this->nodes[0])))*(std::get<1>(this->nodes[2])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2])))+(((((((((0.0833333333333)*(std::get<1>(this->nodes[0])))*(std::get<1>(this->nodes[2])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1])))-((((((((0.166666666667)*(std::get<1>(this->nodes[0])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[0]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2])))+((((((((0.166666666667)*(std::get<1>(this->nodes[0])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[0]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1])))+((((((((0.166666666667)*(std::get<1>(this->nodes[0])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[0]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2])))-((((((((0.166666666667)*(std::get<1>(this->nodes[0])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[0]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1])))-((((((((0.166666666667)*(std::get<1>(this->nodes[0])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[0]))*(other->nodeBasis[1].coefficients[1])))+((((((((0.166666666667)*(std::get<1>(this->nodes[0])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[0])))+((((((((0.166666666667)*(std::get<1>(this->nodes[0])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[0]))*(other->nodeBasis[1].coefficients[1])))-((((((((0.166666666667)*(std::get<1>(this->nodes[0])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[0])))+((((((((0.0833333333333)*((std::get<0>(this->nodes[1]))*(std::get<0>(this->nodes[1]))))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2])))-((((((((0.0833333333333)*((std::get<0>(this->nodes[1]))*(std::get<0>(this->nodes[1]))))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1])))-((((((((0.0833333333333)*((std::get<0>(this->nodes[1]))*(std::get<0>(this->nodes[1]))))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2])))+((((((((0.0833333333333)*((std::get<0>(this->nodes[1]))*(std::get<0>(this->nodes[1]))))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1])))+(((((((((0.0833333333333)*(std::get<0>(this->nodes[1])))*(std::get<0>(this->nodes[2])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2])))-(((((((((0.0833333333333)*(std::get<0>(this->nodes[1])))*(std::get<0>(this->nodes[2])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1])))-(((((((((0.0833333333333)*(std::get<0>(this->nodes[1])))*(std::get<0>(this->nodes[2])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2])))+(((((((((0.0833333333333)*(std::get<0>(this->nodes[1])))*(std::get<0>(this->nodes[2])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1])))+((((((((0.166666666667)*(std::get<0>(this->nodes[1])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[0]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2])))-((((((((0.166666666667)*(std::get<0>(this->nodes[1])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[0]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1])))+((((((((0.166666666667)*(std::get<0>(this->nodes[1])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[0]))*(other->nodeBasis[1].coefficients[2])))-((((((((0.166666666667)*(std::get<0>(this->nodes[1])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[0])))-((((((((0.166666666667)*(std::get<0>(this->nodes[1])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[0]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2])))+((((((((0.166666666667)*(std::get<0>(this->nodes[1])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[0]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1])))-((((((((0.166666666667)*(std::get<0>(this->nodes[1])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[0]))*(other->nodeBasis[1].coefficients[2])))+((((((((0.166666666667)*(std::get<0>(this->nodes[1])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[0])))+((((((((0.0833333333333)*((std::get<1>(this->nodes[1]))*(std::get<1>(this->nodes[1]))))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2])))-((((((((0.0833333333333)*((std::get<1>(this->nodes[1]))*(std::get<1>(this->nodes[1]))))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1])))-((((((((0.0833333333333)*((std::get<1>(this->nodes[1]))*(std::get<1>(this->nodes[1]))))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2])))+((((((((0.0833333333333)*((std::get<1>(this->nodes[1]))*(std::get<1>(this->nodes[1]))))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1])))+(((((((((0.0833333333333)*(std::get<1>(this->nodes[1])))*(std::get<1>(this->nodes[2])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2])))-(((((((((0.0833333333333)*(std::get<1>(this->nodes[1])))*(std::get<1>(this->nodes[2])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1])))-(((((((((0.0833333333333)*(std::get<1>(this->nodes[1])))*(std::get<1>(this->nodes[2])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2])))+(((((((((0.0833333333333)*(std::get<1>(this->nodes[1])))*(std::get<1>(this->nodes[2])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1])))-((((((((0.166666666667)*(std::get<1>(this->nodes[1])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[0]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2])))+((((((((0.166666666667)*(std::get<1>(this->nodes[1])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[0]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1])))+((((((((0.166666666667)*(std::get<1>(this->nodes[1])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[0]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2])))-((((((((0.166666666667)*(std::get<1>(this->nodes[1])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[0]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1])))-((((((((0.166666666667)*(std::get<1>(this->nodes[1])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[0]))*(other->nodeBasis[1].coefficients[1])))+((((((((0.166666666667)*(std::get<1>(this->nodes[1])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[0])))+((((((((0.166666666667)*(std::get<1>(this->nodes[1])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[0]))*(other->nodeBasis[1].coefficients[1])))-((((((((0.166666666667)*(std::get<1>(this->nodes[1])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[0])))+((((((((0.0833333333333)*((std::get<0>(this->nodes[2]))*(std::get<0>(this->nodes[2]))))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2])))-((((((((0.0833333333333)*((std::get<0>(this->nodes[2]))*(std::get<0>(this->nodes[2]))))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1])))-((((((((0.0833333333333)*((std::get<0>(this->nodes[2]))*(std::get<0>(this->nodes[2]))))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2])))+((((((((0.0833333333333)*((std::get<0>(this->nodes[2]))*(std::get<0>(this->nodes[2]))))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1])))+((((((((0.166666666667)*(std::get<0>(this->nodes[2])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[0]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2])))-((((((((0.166666666667)*(std::get<0>(this->nodes[2])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[0]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1])))+((((((((0.166666666667)*(std::get<0>(this->nodes[2])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[0]))*(other->nodeBasis[1].coefficients[2])))-((((((((0.166666666667)*(std::get<0>(this->nodes[2])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[0])))-((((((((0.166666666667)*(std::get<0>(this->nodes[2])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[0]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2])))+((((((((0.166666666667)*(std::get<0>(this->nodes[2])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[0]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1])))-((((((((0.166666666667)*(std::get<0>(this->nodes[2])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[0]))*(other->nodeBasis[1].coefficients[2])))+((((((((0.166666666667)*(std::get<0>(this->nodes[2])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[0])))+((((((((0.0833333333333)*((std::get<1>(this->nodes[2]))*(std::get<1>(this->nodes[2]))))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2])))-((((((((0.0833333333333)*((std::get<1>(this->nodes[2]))*(std::get<1>(this->nodes[2]))))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1])))-((((((((0.0833333333333)*((std::get<1>(this->nodes[2]))*(std::get<1>(this->nodes[2]))))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2])))+((((((((0.0833333333333)*((std::get<1>(this->nodes[2]))*(std::get<1>(this->nodes[2]))))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1])))-((((((((0.166666666667)*(std::get<1>(this->nodes[2])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[0]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2])))+((((((((0.166666666667)*(std::get<1>(this->nodes[2])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[0]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1])))+((((((((0.166666666667)*(std::get<1>(this->nodes[2])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[0]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2])))-((((((((0.166666666667)*(std::get<1>(this->nodes[2])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[0]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1])))-((((((((0.166666666667)*(std::get<1>(this->nodes[2])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[0]))*(other->nodeBasis[1].coefficients[1])))+((((((((0.166666666667)*(std::get<1>(this->nodes[2])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[0])))+((((((((0.166666666667)*(std::get<1>(this->nodes[2])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[0]))*(other->nodeBasis[1].coefficients[1])))-((((((((0.166666666667)*(std::get<1>(this->nodes[2])))*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[0])))+(((((((0.5)*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[0]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[0]))*(other->nodeBasis[1].coefficients[1])))-(((((((0.5)*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[0]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[0])))+(((((((0.5)*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[0]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[0]))*(other->nodeBasis[1].coefficients[2])))-(((((((0.5)*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[0]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[0])))-(((((((0.5)*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[0]))*(other->nodeBasis[0].coefficients[0]))*(other->nodeBasis[1].coefficients[1])))+(((((((0.5)*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[0]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[0])))-(((((((0.5)*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[0]))*(other->nodeBasis[0].coefficients[0]))*(other->nodeBasis[1].coefficients[2])))+(((((((0.5)*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[0]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[0]))))*(abs(((((-(std::get<0>(this->nodes[0])))+(std::get<0>(this->nodes[1])))*((-(std::get<1>(this->nodes[0])))+(std::get<1>(this->nodes[2]))))-(((-(std::get<0>(this->nodes[0])))+(std::get<0>(this->nodes[2])))*((-(std::get<1>(this->nodes[0])))+(std::get<1>(this->nodes[1]))))))));
})
;
}


// integrate gradient with basis

mpFlow::dtype::real mpFlow::FEM::basis::Edge::integrateGradientWithBasis(
    const std::shared_ptr<Edge> other
    ) {
    return ({
(((1.0)*((((((((((2.0)*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2]))-(((((((2.0)*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[1]))*(this->nodeBasis[1].coefficients[2]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1])))-(((((((2.0)*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[1]))*(other->nodeBasis[1].coefficients[2])))+(((((((2.0)*(this->length))*(other->length))*(this->nodeBasis[0].coefficients[2]))*(this->nodeBasis[1].coefficients[1]))*(other->nodeBasis[0].coefficients[2]))*(other->nodeBasis[1].coefficients[1]))))*(abs(((((-(std::get<0>(this->nodes[0])))+(std::get<0>(this->nodes[1])))*((-(std::get<1>(this->nodes[0])))+(std::get<1>(this->nodes[2]))))-(((-(std::get<0>(this->nodes[0])))+(std::get<0>(this->nodes[2])))*((-(std::get<1>(this->nodes[0])))+(std::get<1>(this->nodes[1]))))))));
})
;
}

